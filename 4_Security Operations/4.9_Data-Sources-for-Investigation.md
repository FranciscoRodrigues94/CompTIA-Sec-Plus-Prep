# 4.9 Given a scenario, use data sources to support an investigation

This module focuses on the various data sources available to security professionals for supporting investigations during and after a security incident. The ability to collect, analyze, and correlate data from diverse sources is crucial for understanding an attack, identifying its scope, and facilitating recovery.

---

## Using Data Sources to Support an Investigation

### Log data

Records of events and activities generated by various systems and applications, providing a chronological trail of events.

* **Firewall logs:**
    * **Description:** Records of traffic that firewalls have permitted or denied, including source/destination IP addresses, ports, protocols, and timestamps.
    * **Use in Investigation:** Essential for understanding network flow, identifying unauthorized access attempts, denied connections, and policy violations. Can show if an attacker tried to reach specific internal systems or if data exfiltration attempts were made.
* **Application logs:**
    * **Description:** Records generated by software applications, detailing events specific to that application, such as user logins/logouts, failed authentication attempts, database queries, and specific application errors.
    * **Use in Investigation:** Helps pinpoint application-layer attacks (e.g., SQL injection, cross-site scripting), identify compromised user accounts within an application, and trace activity related to data manipulation or access within the application.
* **Endpoint logs:**
    * **Description:** Logs from individual workstations, servers, and other endpoints, including system events, process execution, file access, and security software (e.g., antivirus) activity.
    * **Use in Investigation:** Provides granular detail on what happened on a specific device, such as malware execution, unauthorized software installation, suspicious file modifications, or user actions that indicate compromise.
* **OS-specific security logs:**
    * **Description:** Logs generated by the operating system's security features (e.g., Windows Security Event Log, Linux `auth.log` and `syslog`). They record authentication attempts, privilege escalations, audit policy changes, and object access.
    * **Use in Investigation:** Critical for understanding user activity, privilege escalation attempts, system configuration changes, and successful/failed authentication events.
* **IPS/IDS logs:**
    * **Description:** Records of alerts generated by Intrusion Prevention Systems (IPS) and Intrusion Detection Systems (IDS), detailing detected malicious activity, attack signatures matched, and associated traffic.
    * **Use in Investigation:** Provides early warning of potential attacks, identifies specific attack types, and helps pinpoint when and how an intrusion attempt occurred.
* **Network logs:**
    * **Description:** General logs from network devices (routers, switches) and network services (DNS, DHCP), showing connection information, routing changes, and service requests. Often includes NetFlow or IPFIX data.
    * **Use in Investigation:** Helps map network topology, understand traffic patterns, identify unusual connections, and track lateral movement within the network.
* **Metadata:**
    * **Description:** Data about data (e.g., file creation date, last modified date, author, file size, permissions, camera settings for images).
    * **Use in Investigation:** Can reveal hidden information, such as who created a malicious file, when it was last modified, or if an attacker tried to clean up their tracks. Important for digital forensics.

### Data sources

Other types of information or outputs from security tools that can aid investigations.

* **Vulnerability scans:**
    * **Description:** Reports from vulnerability scanners detailing known security weaknesses present on systems or applications.
    * **Use in Investigation:** Helps determine if an exploited vulnerability was known and unpatched. Can identify the initial attack vector used in a breach.
* **Automated reports:**
    * **Description:** Scheduled or on-demand reports from security tools (e.g., SIEM, DLP, EDR) summarizing security events, incidents, compliance status, or detected anomalies.
    * **Use in Investigation:** Provides high-level overviews and trends, helping to quickly grasp the scope of an incident or identify recurring issues. Can support executive-level briefings.
* **Dashboards:**
    * **Description:** Visual representations of real-time or near real-time security data, often found in SIEMs, EDR platforms, or specialized security monitoring tools.
    * **Use in Investigation:** Provides quick, at-a-glance insights into critical security metrics, active alerts, and system health during an ongoing investigation, helping to spot anomalous activity.
* **Packet captures (PCAP):**
    * **Description:** Raw network traffic data captured in a file format, allowing for deep-level analysis of individual network packets.
    * **Use in Investigation:** Provides the most granular detail of network communication. Crucial for reconstructing attack sequences, identifying command-and-control channels, exfiltrated data content, and specific malware communication. Essential when other logs are insufficient or compromised.
